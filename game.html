<!DOCTYPE html>
<!-- Sla dit bestand op als game.html en open het in je browser.
    Dit bestand bevat level 1. Als je het doel bereikt, opent level 2 in een nieuwe pagina (nieuw venster/tab). -->
<html lang="nl">
<head>
<meta charset="utf-8" />
<title>Mini Game - Level 1</title>
<style>
  body { margin:0; display:flex; height:100vh; align-items:center; justify-content:center; background:#222; color:#eee; font-family:sans-serif; }
  #game { background:#111; border:4px solid #333; width:640px; height:360px; position:relative; }
  canvas { background:#0b0b0b; display:block; }
  #hud { position:absolute; left:8px; top:8px; }
  #msg { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); background:rgba(0,0,0,0.8); padding:16px; border-radius:8px; display:none; }
  button { padding:8px 12px; margin-top:8px; }
</style>
</head>
<body>
  <div id="game">
     <canvas id="c" width="640" height="360"></canvas>
     <div id="hud">Level 1 - Gebruik pijltjestoetsen om te bewegen</div>
     <div id="msg">
        <div id="msgText"></div>
        <div style="text-align:center;">
          <button id="toLevel2">Ga naar Level 2 (nieuwe pagina)</button>
        </div>
     </div>
  </div>

<script>
// Eenvoudige canvas "game" met een speler en doel.
// Bij het bereiken van het doel opent een nieuwe pagina met level 2.

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

const state = {
  player: { x:40, y:280, w:24, h:40, vx:0, vy:0, speed:2.2 },
  goal:   { x:560, y:280, w:40, h:40 },
  gravity: 0.5,
  keys: {},
  onGround: false,
  finished: false
};

window.addEventListener('keydown', e => state.keys[e.key] = true);
window.addEventListener('keyup', e => state.keys[e.key] = false);

// simpele platform
const platforms = [
  { x:0, y:320, w:640, h:40 }
];

function rectsIntersect(a,b){
  return !(a.x + a.w < b.x || a.x > b.x + b.w || a.y + a.h < b.y || a.y > b.y + b.h);
}

function update(){
  if(state.finished) return;

  // input
  if(state.keys['ArrowLeft'] || state.keys['a']) state.player.vx = -state.player.speed;
  else if(state.keys['ArrowRight'] || state.keys['d']) state.player.vx = state.player.speed;
  else state.player.vx = 0;

  if((state.keys['ArrowUp'] || state.keys['w'] || state.keys[' ']) && state.onGround){
     state.player.vy = -9;
     state.onGround = false;
  }

  // physics
  state.player.vy += state.gravity;
  state.player.x += state.player.vx;
  state.player.y += state.player.vy;

  // simple collision with platforms
  state.onGround = false;
  platforms.forEach(p => {
     if(rectsIntersect(state.player, p)){
        // resolve vertical collision only
        if(state.player.vy > 0){
          state.player.y = p.y - state.player.h;
          state.player.vy = 0;
          state.onGround = true;
        } else if(state.player.vy < 0){
          state.player.y = p.y + p.h;
          state.player.vy = 0;
        }
     }
  });

  // keep inside bounds
  state.player.x = Math.max(0, Math.min(canvas.width - state.player.w, state.player.x));

  // check goal
  if(rectsIntersect(state.player, state.goal)){
     finishLevel();
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // background
  ctx.fillStyle = '#0b0b0b';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // platforms
  ctx.fillStyle = '#444';
  platforms.forEach(p => ctx.fillRect(p.x, p.y, p.w, p.h));

  // goal
  ctx.fillStyle = '#0f9';
  ctx.fillRect(state.goal.x, state.goal.y, state.goal.w, state.goal.h);
  ctx.fillStyle = '#023';
  ctx.font = '16px sans-serif';
  ctx.fillText('Goal', state.goal.x + 6, state.goal.y + 24);

  // player
  ctx.fillStyle = '#58a';
  ctx.fillRect(state.player.x, state.player.y, state.player.w, state.player.h);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();

const msg = document.getElementById('msg');
const msgText = document.getElementById('msgText');
const toLevel2 = document.getElementById('toLevel2');

function finishLevel(){
  state.finished = true;
  msgText.textContent = 'Gefeliciteerd! Level 1 voltooid.';
  msg.style.display = 'block';
  // laat gebruiker klikken om level 2 te openen in nieuwe pagina
}

// Maak de HTML-code voor level 2 als string en open het in een nieuwe pagina/tab
toLevel2.addEventListener('click', () => {
  const level2HTML = `
     <!DOCTYPE html>
     <html lang="nl">
     <head>
        <meta charset="utf-8" />
        <title>Mini Game - Level 2</title>
        <style>
          body { margin:0; display:flex; height:100vh; align-items:center; justify-content:center; background:#1b1b30; color:#eee; font-family:sans-serif; }
          #game { background:#0b0b0b; border:4px solid #333; width:700px; height:380px; position:relative; }
          canvas { display:block; background:linear-gradient(#081,#012); }
          #hint { position:absolute; left:8px; top:8px; }
        </style>
     </head>
     <body>
        <div id="game">
          <canvas id="c" width="700" height="380"></canvas>
          <div id="hint">Level 2 - Sneller: gebruik pijltjestoetsen. Verzamel het blauwe vak om te winnen.</div>
        </div>
        <script>
          const c = document.getElementById('c'), ctx=c.getContext('2d');
          const state = {
             player:{x:40,y:300,w:26,h:40,vx:0,vy:0,speed:3.2},
             goal:{x:600,y:260,w:36,h:36},
             gravity:0.6, keys:{}, onGround:false, finished:false
          };
          window.addEventListener('keydown', e=> state.keys[e.key]=true);
          window.addEventListener('keyup', e=> state.keys[e.key]=false);
          const platforms=[ {x:0,y:340,w:700,h:40}, {x:200,y:280,w:120,h:12}, {x:380,y:220,w:120,h:12} ];
          function rectsIntersect(a,b){ return !(a.x + a.w < b.x || a.x > b.x + b.w || a.y + a.h < b.y || a.y > b.y + b.h); }
          function update(){
             if(state.finished) return;
             if(state.keys['ArrowLeft']||state.keys['a']) state.player.vx = -state.player.speed;
             else if(state.keys['ArrowRight']||state.keys['d']) state.player.vx = state.player.speed;
             else state.player.vx = 0;
             if((state.keys['ArrowUp']||state.keys['w']||state.keys[' ']) && state.onGround){ state.player.vy = -10; state.onGround=false; }
             state.player.vy += state.gravity;
             state.player.x += state.player.vx; state.player.y += state.player.vy;
             state.onGround=false;
             platforms.forEach(p=>{
                if(rectsIntersect(state.player,p)){
                  if(state.player.vy > 0){ state.player.y = p.y - state.player.h; state.player.vy = 0; state.onGround=true; }
                  else if(state.player.vy < 0){ state.player.y = p.y + p.h; state.player.vy = 0; }
                }
             });
             state.player.x = Math.max(0, Math.min(c.width - state.player.w, state.player.x));
             if(rectsIntersect(state.player, state.goal)) { state.finished = true; setTimeout(()=> alert('Je hebt level 2 gehaald!'),50); }
          }
          function draw(){
             ctx.clearRect(0,0,c.width,c.height);
             ctx.fillStyle='#022'; ctx.fillRect(0,0,c.width,c.height);
             ctx.fillStyle='#345'; platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.w,p.h));
             ctx.fillStyle='#09f'; ctx.fillRect(state.goal.x,state.goal.y,state.goal.w,state.goal.h);
             ctx.fillStyle='#fb6'; ctx.fillRect(state.player.x,state.player.y,state.player.w,state.player.h);
          }
          (function loop(){ update(); draw(); requestAnimationFrame(loop); })();
        </script>
     </body>
     </html>
  `;
  const newWin = window.open();
  if(!newWin){
     alert('Popup geblokkeerd. Open level 2 in een nieuw tabblad: kopieer de inhoud of sta popups toe.');
     return;
  }
  newWin.document.open();
  newWin.document.write(level2HTML);
  newWin.document.close();
});
</script>
</body>
</html>